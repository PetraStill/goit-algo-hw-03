"""
Ця програма будує фрактал «сніжинка Коха» за допомогою модуля turtle.

Користувач може вказати рівень рекурсії, після чого алгоритм рекурсивно
генерує криву Коха та об’єднує три такі криві у повну сніжинку.

Основні частини:
- koch_segment(): рекурсивна побудова одного сегмента кривої Коха;
- draw_koch_snowflake(): малювання повної сніжинки з трьох сегментів;
- main(): зчитування рівня рекурсії та запуск візуалізації.

Рекурсія використовується для поділу кожного відрізка на три частини
та заміни середнього відрізка ламаною, що створює характерну форму фракталу.
"""

import turtle


def koch_segment(t: turtle.Turtle, order: int, length: float) -> None:
    """
    Малює один сегмент кривої Коха.

    Пояснення:
    - Якщо order == 0, малюємо звичайну пряму лінію (базовий випадок).
    - Якщо order > 0, замінюємо лінію на 4 менші сегменти:
        1) рух уперед (рівна ділянка);
        2) поворот ліворуч на 60° (утворення "верхнього зубця");
        3) поворот праворуч на 120°;
        4) поворот ліворуч на 60°.
      Кожен сегмент зменшується у 3 рази — це основа фракталу Коха.
    """
    if order == 0:
        t.forward(length)  # Малюємо пряму лінію базової довжини
    else:
        # Кути поворотів для кожного з 4 підсегментів
        for angle in (60, -120, 60, 0):
            koch_segment(t, order - 1, length / 3)  # Рекурсивно малюємо менший сегмент
            t.left(angle)  # Поворот на заданий кут


def draw_koch_snowflake(order: int, size: float = 300.0) -> None:
    """
    Малює сніжинку Коха, яка складається з трьох кривих Коха,
    розташованих під кутами 120°, утворюючи рівносторонній трикутник.

    Аргументи:
    - order: рівень рекурсії;
    - size: довжина сторони сніжинки.
    """
    window = turtle.Screen()
    window.bgcolor("white")  # Білий фон

    t = turtle.Turtle()
    t.speed(0)               # Максимальна швидкість малювання
    t.hideturtle()           # Ховаємо "черепашку"
    t.penup()
    t.goto(-size / 2, size / 3)  # Початкова позиція трохи вище центру
    t.pendown()

    # Малюємо три сторони "трикутника" Коха
    for _ in range(3):
        koch_segment(t, order, size)
        t.right(120)  # Повертаємо на наступну сторону

    window.mainloop()  # Залишаємо вікно відкритим


def main() -> None:
    """Зчитує рівень рекурсії та запускає візуалізацію."""
    try:
        level_str = input("Введіть рівень рекурсії (ціле число >= 0): ")
        level = int(level_str)  # Конвертуємо рядок у число
        if level < 0:
            print("Рівень рекурсії має бути невід’ємним цілим числом.")
            return
    except ValueError:
        print("Потрібно ввести ціле число.")
        return

    draw_koch_snowflake(level)


if __name__ == "__main__":
    main()
